<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/pages/template/default.xhtml"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">

	<ui:define name="content">
		<p:breadCrumb>
		    <p:menuitem value="#{message['pao.home']}" url="#" />
		   	<p:menuitem value="#{message['pao.projeto']}"
				outcome="pretty:projeto"/>
			<p:menuitem value="#{message['pao.alocacao']}"
				outcome="pretty:alocacao" disabled="true" />
		</p:breadCrumb>
		<div>
			<h2>#{message['title.alocacao']}</h2>
			<p:growl id="growl" life="4000" globalOnly="true" sticky="true" />
			<h:form>
				<br />
				
				<p:selectOneMenu styleClass="dropdown-pesquisa"
								id="celula"
							 	value="#{alocacaoManager.celula}"
							 	onchange="submit()"
							 	valueChangeListener="#{alocacaoManager.valueChangeCelula}"
								converter="entityConverterSelectOneMenu" >
					<f:selectItem itemLabel="#{message['select.celula']}" noSelectionOption="true" />
					<f:selectItems value="#{celulaManager.listarAtivos()}"
								var="celula"
								itemLabel="#{celula.nome}"
								itemValue="#{celula}" />
					<p:ajax update="gridRecursos gridProjetos" event="change" process="@this" />
				</p:selectOneMenu>
				
				<p:selectOneMenu styleClass="dropdown-pesquisa"
								id="equipe"
							 	value="#{alocacaoManager.equipe}"
							 	onchange="submit()"
							 	valueChangeListener="#{alocacaoManager.valueChangeEquipe}"
								converter="entityConverterSelectOneMenu" >
					<f:selectItem itemLabel="#{message['select.equipe']}" noSelectionOption="true" />
					<f:selectItems value="#{equipeManager.listarAtivos()}"
								var="equipe"
								itemLabel="#{equipe.nome}"
								itemValue="#{equipe}" />
					<p:ajax update="gridRecursos gridProjetos" event="change" process="@this" />	
				</p:selectOneMenu>
				<div class="pesquisa">
				<h3>#{message['title.recurso.ativo']} <h:outputLabel value=" - #{alocacaoManager.celula.nome} - #{alocacaoManager.equipe.nome}" /></h3>
					
					<p:dataTable id="gridRecursos" 
								var="recurso"
								value="#{alocacaoManager.listaRecursosAtivos}"
								emptyMessage="#{message['alerta.listaVazia']}">
		
						<p:column headerText="#{message['label.nome']}" for="recursoNome">
							<h:outputText value="#{recurso.profissional.nome}" id="recursoNome"/>
						</p:column>
						
						<p:column headerText="#{message['label.profissional.cargo']}" for="recursoCargo">
							<h:outputText value="#{recurso.profissional.cargo.nome}" id="recursoCargo" />
						</p:column>
					
						<p:column headerText="#{message['label.cargaHoraria']}" for="recursoCargaHoraria" >
							<h:outputText value="#{recurso.profissional.cargaHoraria.cargaHoraria}" id="recursoCargaHoraria">
								<f:converter converterId="cargaHorariaConverter"/>
							</h:outputText>
						</p:column>
							
						<p:column headerText="#{message['label.profissional.valorHora']}" for="recursoValorHora">
							<h:outputText value="#{recurso.profissional.valorHora}" id="recursoValorHora"/>
						</p:column>
					</p:dataTable>
				</div>
				<br />
				<h3>Projetos</h3>
					
					<p:dataTable id="gridProjetos" 
								var="projeto"
								value="#{alocacaoManager.listaProjetosEAlocacoes}"
								emptyMessage="#{message['alerta.listaVazia']}">
		
						<p:column headerText="#{message['label.projeto.codigo']}">
						<h:outputText value="#{alocacao.projeto.codigo}" />
					</p:column>

					<p:column headerText="#{message['label.nome']}">
						<h:outputText value="#{projeto.nome}" />
					</p:column>
					
					<p:column headerText="#{message['label.profissional.equipe']}">
						<h:outputText value="#{projeto.equipe.nome}" />
					</p:column>

					<p:column headerText="#{message['label.projeto.budget']}">
						<h:outputText value="#{projeto.budget}">
							<f:convertNumber minFractionDigits="2" type="currency"
								currencySymbol="R$" />
						</h:outputText>
					</p:column>

					<p:column headerText="#{message['label.projeto.dataInicial']}">
						<h:outputText value="#{projeto.dataInicio}" >
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<p:column headerText="#{message['label.projeto.dataFinal']}">
						<h:outputText value="#{projeto.dataFim}" >
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>
					</p:dataTable>
			</h:form>
			</div>		
	</ui:define>

</ui:composition>